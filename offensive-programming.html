<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> 3 Offensive programming | Offensive Programming Book</title>
  <meta name="description" content="wyz.code.offensiveProgramming package related documentation">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content=" 3 Offensive programming | Offensive Programming Book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="figures/op.png" />
  <meta property="og:description" content="wyz.code.offensiveProgramming package related documentation" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 3 Offensive programming | Offensive Programming Book" />
  
  <meta name="twitter:description" content="wyz.code.offensiveProgramming package related documentation" />
  <meta name="twitter:image" content="figures/op.png" />

<meta name="author" content="Fabien GELINEAU neonira@gmail.com">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="application-in-r-language.html">
<link rel="next" href="methods.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Offensive Programming Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Cover</a></li>
<li class="chapter" data-level="" data-path="preamble.html"><a href="preamble.html"><i class="fa fa-check"></i>Preamble</a></li>
<li class="chapter" data-level="1" data-path="programming-styles.html"><a href="programming-styles.html"><i class="fa fa-check"></i><b>1</b> Programming styles</a><ul>
<li class="chapter" data-level="1.1" data-path="programming-styles.html"><a href="programming-styles.html#defensive-programming-style"><i class="fa fa-check"></i><b>1.1</b> Defensive programming style</a></li>
<li class="chapter" data-level="1.2" data-path="programming-styles.html"><a href="programming-styles.html#offensive-programming-style"><i class="fa fa-check"></i><b>1.2</b> Offensive programming style</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="application-in-r-language.html"><a href="application-in-r-language.html"><i class="fa fa-check"></i><b>2</b> Application in R language</a><ul>
<li class="chapter" data-level="2.1" data-path="application-in-r-language.html"><a href="application-in-r-language.html#a-simple-case"><i class="fa fa-check"></i><b>2.1</b> A simple case</a></li>
<li class="chapter" data-level="2.2" data-path="application-in-r-language.html"><a href="application-in-r-language.html#defensive-programming"><i class="fa fa-check"></i><b>2.2</b> Defensive programming</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="offensive-programming.html"><a href="offensive-programming.html"><i class="fa fa-check"></i><b>3</b> Offensive programming</a><ul>
<li class="chapter" data-level="3.1" data-path="offensive-programming.html"><a href="offensive-programming.html#what-is-different"><i class="fa fa-check"></i><b>3.1</b> What is different?</a><ul>
<li class="chapter" data-level="3.1.1" data-path="offensive-programming.html"><a href="offensive-programming.html#semantic-argument-naming"><i class="fa fa-check"></i><b>3.1.1</b> Semantic argument naming</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="offensive-programming.html"><a href="offensive-programming.html#back-to-definition"><i class="fa fa-check"></i><b>3.2</b> Back to definition</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>4</b> Methods</a></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a><ul>
<li class="chapter" data-level="5.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>5.1</b> Example one</a></li>
<li class="chapter" data-level="5.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>5.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://www.linkedin.com/in/fabiengelineau" target="blank">instigator Fabien GELINEAU</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Offensive Programming Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="offensive-programming" class="section level1">
<h1><span class="header-section-number"> 3</span> Offensive programming</h1>
<p>Consider following <cite class='it'>R</cite> class implementation which provides some basic mathematic operations.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressMessages</span>(<span class="kw">require</span>(data.table))
MathOperation &lt;-<span class="st"> </span><span class="cf">function</span>() {
  self &lt;-<span class="st"> </span><span class="kw">environment</span>()
  <span class="kw">class</span>(self) &lt;-<span class="st"> </span><span class="kw">append</span>(<span class="st">&#39;Addition&#39;</span>, <span class="kw">class</span>(self))

  add &lt;-<span class="st"> </span><span class="cf">function</span>(x_r, y_r) x_r <span class="op">+</span><span class="st"> </span>y_r
  
  multiply &lt;-<span class="st"> </span><span class="cf">function</span>(x_r, y_r) x_r <span class="op">*</span><span class="st"> </span>y_r
  
  divide &lt;-<span class="st"> </span><span class="cf">function</span>(x_r, y_r) x_r <span class="op">/</span><span class="st"> </span>y_r
  
  function_return_types &lt;-<span class="st"> </span><span class="kw">data.table</span>(
    <span class="dt">function_name =</span> <span class="kw">c</span>(<span class="st">&#39;add&#39;</span>, <span class="st">&#39;multiply&#39;</span>, <span class="st">&#39;divide&#39;</span>),
    <span class="dt">return_value =</span> <span class="kw">c</span>(<span class="st">&#39;x_r&#39;</span>, <span class="st">&#39;x_r&#39;</span>, <span class="st">&#39;x_d&#39;</span>)
  )

  self
}</code></pre>
<div id="what-is-different" class="section level2">
<h2><span class="header-section-number">3.1</span> What is different?</h2>
<p>Compare to previously shown implementation, here are the two main differences</p>
<ol style="list-style-type: decimal">
<li>arguments are renamed according to a pattern</li>
<li>a variable named <cite class='it'>function_return_types</cite> has been added. It holds a (ref:data.table) that defines expected function return types.</li>
</ol>
<p>That’s it. Function implementation is exactly the same. No change done elsewhere. Everything is there and should be sufficient to solve many of the faced issues.</p>
<div id="semantic-argument-naming" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Semantic argument naming</h3>
<p>Arguments have been renamed from <cite class='kw'>x</cite> to <cite class='kw'>x_r</cite>.
What does that mean? Syntactically, it changes nothing for R. For us humans, it changes a lot of things, as this follows a pattern that allows to specify a lot of things in a short, concise, reliable way.</p>
<p>The pattern is simple to understand. It is separated by underscore. Its parts can be up to three, and the second and third parts are optionals. First part, is the variable name. Second part is the type of the variable. Third part is the length contrainst specification. More precisely, here are the conventions that apply on each parts</p>
<table>
<thead>
<tr class="header">
<th align="center">part name</th>
<th align="center">name compliance</th>
<th align="center">PERL part format</th>
<th align="center">optional</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">variable name</td>
<td align="center">STRICT</td>
<td align="center">[a-z][A-Za-z0-9]*</td>
<td align="center">FALSE</td>
</tr>
<tr class="even">
<td align="center">variable name</td>
<td align="center">LAZY</td>
<td align="center">[A-Za-z0-9_.]*</td>
<td align="center">FALSE</td>
</tr>
<tr class="odd">
<td align="center">type specification</td>
<td align="center">STRICT</td>
<td align="center">[A-Za-z][A-Za-z0-9_.]*</td>
<td align="center">TRUE</td>
</tr>
<tr class="even">
<td align="center">length constraint</td>
<td align="center">STRICT</td>
<td align="center">([1-9][0-9]*(l</td>
<td align="center">m</td>
</tr>
</tbody>
</table>
<p>The strict syntax is the one recommended to stick with. For legacy R code, understand any R code, that does
use defensive programming whatever its creation date, lazy syntax is to be used.</p>
<div id="some-examples-of-semantic-argument-naming" class="section level4">
<h4><span class="header-section-number">3.1.1.1</span> Some examples of semantic argument naming</h4>
<p>I wish to create a parameter name that will hold integer values? How may I achieved that?</p>
<p>Quite easily, either use <cite class='kw'>value_i</cite> if you want to use R integer definition or use <cite class='kw'>value_mi</cite> if you want a mathematical integer, based on R integer implementation. What is the difference? A mathematical integer can not take the value <cite class='kw'>NA</cite> that is a <cite class='kw'>logical</cite> and not an integer. Let’s consider that we choose to use <cite class='kw'>value_i</cite>.</p>
<p>What if I know that the parameter will always be of length 3?</p>
<p>Use <cite class='kw'>value_i_3</cite> or <cite class='kw'>value_i_3n</cite>. Main difference is using the former you will have to provide 3, no less - no more, integers. That will be mandatory. No way to turn around. Using the later, you will have the opportunity to give 1 or 3 integers.</p>
<p>What if I don’t know the real length, just a condition, let’s say 5 or more (respectively 5 or less) ?</p>
<p>Use <cite class='kw'>value_i_5m</cite> <cite class='comment'>respectively <cite class='kw'>value_i_5l</cite></cite></p>
<p>What about if the type is changing? I wish to handle a parameter that might come with several types?</p>
<p>Use semantic naming polymorphism scheme, that is instead of specifying explicitely the type as above, use a final underscore in your definition. Variable naming and constraint length if provided, still apply.</p>
<p>Using <cite class='kw'>value_</cite> will declare a polymorphic parameter, unconstrained in length.
Using <cite class='kw'>value_5m_</cite> will declare a polymorphic parameter, constrained with 5 or more entries.</p>
<p>Note that a polymorphic type is not a list. A list is a list, not a polymorphic type, altough it can contains polymorphic values.</p>
</div>
</div>
</div>
<div id="back-to-definition" class="section level2">
<h2><span class="header-section-number">3.2</span> Back to definition</h2>
<p>So now you may be able to translate the variable <cite class='kw'>x_r</cite> by yourself. Just a vector of real values, unconstrained in length. Using this parameter name implies that the the developper is responsible for testing cases of various length and has to prevent weirdness propagation.</p>
<p>For example following R code shows results that require decisions</p>
<pre class="sourceCode r"><code class="sourceCode r">mo &lt;-<span class="st"> </span><span class="kw">MathOperation</span>()

<span class="kw">print</span>(mo<span class="op">$</span><span class="kw">add</span>(<span class="fl">1.0</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="fl">1.0</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">7</span>))
<span class="co">#&gt; Warning in x_r + y_r: la taille d&#39;un objet plus long n&#39;est pas multiple de</span>
<span class="co">#&gt; la taille d&#39;un objet plus court</span>
<span class="co">#&gt; [1] 2 4 6 5 7 9 8</span></code></pre>
<p>This code provides both an output and a warning, because of R recycling on various length vectors. What decision should be taken ? Allow or deny this behaviour ? It depends of your usage. If you are creating a real math library, I would recommand to duplicate the code and create two functions named <cite class='kw'>addRCompliant</cite> and <cite class='kw'>addMathCompliant</cite>. Later should inforce arguments length control in his body, while former shoud keep the body as is. Note that in the later case, this is not defensive programming but functional scope verification.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="application-in-r-language.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "night",
"family": "serif",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": ["offensive-programming-book.pdf"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
