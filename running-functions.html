<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> 7 Running functions | Offensive Programming Book</title>
  <meta name="description" content="wyz.code.offensiveProgramming package related documentation">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content=" 7 Running functions | Offensive Programming Book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="figures/op.png" />
  <meta property="og:description" content="wyz.code.offensiveProgramming package related documentation" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 7 Running functions | Offensive Programming Book" />
  
  <meta name="twitter:description" content="wyz.code.offensiveProgramming package related documentation" />
  <meta name="twitter:image" content="figures/op.png" />

<meta name="author" content="Fabien GELINEAU neonira@gmail.com">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="evaluation-modes.html">
<link rel="next" href="running-test-cases.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Offensive Programming Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preamble.html"><a href="preamble.html"><i class="fa fa-check"></i>Preamble</a></li>
<li class="chapter" data-level="1" data-path="programming-styles.html"><a href="programming-styles.html"><i class="fa fa-check"></i><b>1</b> Programming styles</a><ul>
<li class="chapter" data-level="1.1" data-path="programming-styles.html"><a href="programming-styles.html#defensive-programming-style"><i class="fa fa-check"></i><b>1.1</b> Defensive programming style</a></li>
<li class="chapter" data-level="1.2" data-path="programming-styles.html"><a href="programming-styles.html#offensive-programming-style"><i class="fa fa-check"></i><b>1.2</b> Offensive programming style</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="application-in-r-language.html"><a href="application-in-r-language.html"><i class="fa fa-check"></i><b>2</b> Application in R language</a><ul>
<li class="chapter" data-level="2.1" data-path="application-in-r-language.html"><a href="application-in-r-language.html#a-simple-case"><i class="fa fa-check"></i><b>2.1</b> A simple case</a></li>
<li class="chapter" data-level="2.2" data-path="application-in-r-language.html"><a href="application-in-r-language.html#defensive-programming"><i class="fa fa-check"></i><b>2.2</b> Defensive programming</a></li>
<li class="chapter" data-level="2.3" data-path="application-in-r-language.html"><a href="application-in-r-language.html#offensive-programming"><i class="fa fa-check"></i><b>2.3</b> Offensive programming</a><ul>
<li class="chapter" data-level="2.3.1" data-path="application-in-r-language.html"><a href="application-in-r-language.html#what-is-different"><i class="fa fa-check"></i><b>2.3.1</b> What is different?</a></li>
<li class="chapter" data-level="2.3.2" data-path="application-in-r-language.html"><a href="application-in-r-language.html#semantic-argument-naming"><i class="fa fa-check"></i><b>2.3.2</b> Semantic argument naming</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="application-in-r-language.html"><a href="application-in-r-language.html#back-to-definition"><i class="fa fa-check"></i><b>2.4</b> Back to definition</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="putting-in-action-wyz-code-offensiveprogramming.html"><a href="putting-in-action-wyz-code-offensiveprogramming.html"><i class="fa fa-check"></i><b>3</b> Putting in action wyz.code.offensiveProgramming</a><ul>
<li class="chapter" data-level="3.1" data-path="putting-in-action-wyz-code-offensiveprogramming.html"><a href="putting-in-action-wyz-code-offensiveprogramming.html#package-overview"><i class="fa fa-check"></i><b>3.1</b> Package overview</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-type-factory.html"><a href="the-type-factory.html"><i class="fa fa-check"></i><b>4</b> The type factory</a><ul>
<li class="chapter" data-level="4.1" data-path="the-type-factory.html"><a href="the-type-factory.html#get-recorded-types-inventory"><i class="fa fa-check"></i><b>4.1</b> Get recorded types inventory</a></li>
<li class="chapter" data-level="4.2" data-path="the-type-factory.html"><a href="the-type-factory.html#register-your-own-type"><i class="fa fa-check"></i><b>4.2</b> Register your own type</a></li>
<li class="chapter" data-level="4.3" data-path="the-type-factory.html"><a href="the-type-factory.html#get-access-to-verification-functions"><i class="fa fa-check"></i><b>4.3</b> Get access to verification functions</a></li>
<li class="chapter" data-level="4.4" data-path="the-type-factory.html"><a href="the-type-factory.html#some-hints"><i class="fa fa-check"></i><b>4.4</b> Some hints</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="semantic-names.html"><a href="semantic-names.html"><i class="fa fa-check"></i><b>5</b> Semantic names</a><ul>
<li class="chapter" data-level="5.1" data-path="semantic-names.html"><a href="semantic-names.html#what-is-semantic-naming"><i class="fa fa-check"></i><b>5.1</b> What is semantic naming?</a></li>
<li class="chapter" data-level="5.2" data-path="semantic-names.html"><a href="semantic-names.html#verifying-a-function-parameter-or-return-type-declaration"><i class="fa fa-check"></i><b>5.2</b> Verifying a function parameter or return type declaration</a></li>
<li class="chapter" data-level="5.3" data-path="semantic-names.html"><a href="semantic-names.html#verifying-a-class-name"><i class="fa fa-check"></i><b>5.3</b> Verifying a class name</a></li>
<li class="chapter" data-level="5.4" data-path="semantic-names.html"><a href="semantic-names.html#verifying-a-function-name"><i class="fa fa-check"></i><b>5.4</b> Verifying a function name</a></li>
<li class="chapter" data-level="5.5" data-path="semantic-names.html"><a href="semantic-names.html#get-naming-balance-from-an-r-object"><i class="fa fa-check"></i><b>5.5</b> Get naming balance from an R object</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="evaluation-modes.html"><a href="evaluation-modes.html"><i class="fa fa-check"></i><b>6</b> Evaluation modes</a><ul>
<li class="chapter" data-level="6.1" data-path="evaluation-modes.html"><a href="evaluation-modes.html#understanding-evaluation-modes"><i class="fa fa-check"></i><b>6.1</b> Understanding evaluation modes</a></li>
<li class="chapter" data-level="6.2" data-path="evaluation-modes.html"><a href="evaluation-modes.html#instantiating-evaluation-mode"><i class="fa fa-check"></i><b>6.2</b> Instantiating evaluation mode</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="running-functions.html"><a href="running-functions.html"><i class="fa fa-check"></i><b>7</b> Running functions</a><ul>
<li class="chapter" data-level="7.1" data-path="running-functions.html"><a href="running-functions.html#prerequisites"><i class="fa fa-check"></i><b>7.1</b> Prerequisites</a></li>
<li class="chapter" data-level="7.2" data-path="running-functions.html"><a href="running-functions.html#function-return-types-definition-verification"><i class="fa fa-check"></i><b>7.2</b> Function return types definition verification</a></li>
<li class="chapter" data-level="7.3" data-path="running-functions.html"><a href="running-functions.html#transient-invocations"><i class="fa fa-check"></i><b>7.3</b> Transient invocations</a><ul>
<li class="chapter" data-level="7.3.1" data-path="running-functions.html"><a href="running-functions.html#nominal-case"><i class="fa fa-check"></i><b>7.3.1</b> Nominal case</a></li>
<li class="chapter" data-level="7.3.2" data-path="running-functions.html"><a href="running-functions.html#prerequisite-mismatch"><i class="fa fa-check"></i><b>7.3.2</b> Prerequisite mismatch</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="running-functions.html"><a href="running-functions.html#persistent-invocations"><i class="fa fa-check"></i><b>7.4</b> Persistent invocations</a><ul>
<li class="chapter" data-level="7.4.1" data-path="running-functions.html"><a href="running-functions.html#nominal-persistent-case"><i class="fa fa-check"></i><b>7.4.1</b> Nominal persistent case</a></li>
<li class="chapter" data-level="7.4.2" data-path="running-functions.html"><a href="running-functions.html#subtile-change"><i class="fa fa-check"></i><b>7.4.2</b> Subtile change</a></li>
<li class="chapter" data-level="7.4.3" data-path="running-functions.html"><a href="running-functions.html#call-case-with-named-and-positional-parameters"><i class="fa fa-check"></i><b>7.4.3</b> Call case with named and positional parameters</a></li>
<li class="chapter" data-level="7.4.4" data-path="running-functions.html"><a href="running-functions.html#call-case-with-ellipsis"><i class="fa fa-check"></i><b>7.4.4</b> Call case with ellipsis</a></li>
<li class="chapter" data-level="7.4.5" data-path="running-functions.html"><a href="running-functions.html#second-call-case-with-ellipsis"><i class="fa fa-check"></i><b>7.4.5</b> Second call case with ellipsis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="running-test-cases.html"><a href="running-test-cases.html"><i class="fa fa-check"></i><b>8</b> Running test cases</a><ul>
<li class="chapter" data-level="8.1" data-path="running-test-cases.html"><a href="running-test-cases.html#embedding-test-cases-in-class-definition"><i class="fa fa-check"></i><b>8.1</b> Embedding test cases in class definition</a><ul>
<li class="chapter" data-level="8.1.1" data-path="running-test-cases.html"><a href="running-test-cases.html#a-simple-case-1"><i class="fa fa-check"></i><b>8.1.1</b> A simple case</a></li>
<li class="chapter" data-level="8.1.2" data-path="running-test-cases.html"><a href="running-test-cases.html#a-more-complex-case"><i class="fa fa-check"></i><b>8.1.2</b> A more complex case</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="running-test-cases.html"><a href="running-test-cases.html#test-case-definitions-verification"><i class="fa fa-check"></i><b>8.2</b> Test case definitions verification</a></li>
<li class="chapter" data-level="8.3" data-path="running-test-cases.html"><a href="running-test-cases.html#run-a-test-case"><i class="fa fa-check"></i><b>8.3</b> Run a test case</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>9</b> Conclusion</a><ul>
<li class="chapter" data-level="9.1" data-path="conclusion.html"><a href="conclusion.html#benefits-of-offensive-programming"><i class="fa fa-check"></i><b>9.1</b> Benefits of offensive programming</a></li>
<li class="chapter" data-level="9.2" data-path="conclusion.html"><a href="conclusion.html#concerns-of-offensive-programming"><i class="fa fa-check"></i><b>9.2</b> Concerns of offensive programming</a></li>
<li class="chapter" data-level="9.3" data-path="conclusion.html"><a href="conclusion.html#two-extensions"><i class="fa fa-check"></i><b>9.3</b> Two extensions</a><ul>
<li class="chapter" data-level="9.3.1" data-path="conclusion.html"><a href="conclusion.html#unit-test-code-generation"><i class="fa fa-check"></i><b>9.3.1</b> Unit test code generation</a></li>
<li class="chapter" data-level="9.3.2" data-path="conclusion.html"><a href="conclusion.html#manual-pages-production"><i class="fa fa-check"></i><b>9.3.2</b> Manual pages production</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="conclusion.html"><a href="conclusion.html#your-feedback-is-welcome"><i class="fa fa-check"></i><b>9.4</b> Your feedback is welcome</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://www.linkedin.com/in/fabiengelineau" target="blank">instigator Fabien GELINEAU</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Offensive Programming Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="running-functions" class="section level1">
<h1><span class="header-section-number"> 7</span> Running functions</h1>
<p>Our goal is to run a R instrumented function, under a given evaluation mode. To do so, some prerequisites have to be met, prior to use some <cite class='it'>wyz.code.offensiveProgramming</cite> utilities to proceed to the function execution with context capture and human-readable feedback generation.</p>
<div id="prerequisites" class="section level2">
<h2><span class="header-section-number">7.1</span> Prerequisites</h2>
<p>To run a R function is has to be instrumented. Two requirements have to be met</p>
<ol style="list-style-type: decimal">
<li>the function must comply with semantic parameter naming</li>
<li>the function return type must be specified</li>
</ol>
</div>
<div id="function-return-types-definition-verification" class="section level2">
<h2><span class="header-section-number">7.2</span> Function return types definition verification</h2>
<p>To verify function return types definition you may use the low level function <cite class='kw'>verifyFunctionReturnTypesDefinition</cite> or the higher level one named <cite class='kw'>retrieveFunctionReturnTypes</cite>. Indeed, this approach requires persistent instrumentation
of the code.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">retrieveFunctionReturnTypes</span>(<span class="kw">AdditionTCFIG1</span>())
<span class="co">#&gt;      function_name return_value</span>
<span class="co">#&gt; 1:      addNumeric          x_n</span>
<span class="co">#&gt; 2:       addDouble          x_d</span>
<span class="co">#&gt; 3:      addInteger          x_i</span>
<span class="co">#&gt; 4:  addMultiDouble          x_d</span>
<span class="co">#&gt; 5:    divideByZero          x_d</span>
<span class="co">#&gt; 6: addMultiInteger          x_i</span>
<span class="co">#&gt; 7: generateWarning          x_w</span>
<span class="co">#&gt; 8:   generateError         x_er</span></code></pre>
</div>
<div id="transient-invocations" class="section level2 tabset tabset-fade tabset-pills">
<h2><span class="header-section-number">7.3</span> Transient invocations</h2>
<p>Transient means instrumentation is done dynamically and not persisted anywhere. Here is a typical case. That’s a convenient way to discover and to play with package <cite class='it'>wyz.code.offensiveProgramming</cite>.</p>
<div id="nominal-case" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Nominal case</h3>
<pre class="sourceCode r"><code class="sourceCode r">h &lt;-<span class="st"> </span><span class="cf">function</span>(x_s) x_s
<span class="kw">runTransientFunction</span>(h, <span class="kw">list</span>(<span class="st">&#39;neonira&#39;</span>), <span class="kw">EvaluationMode</span>(<span class="kw">defineEvaluationModes</span>()[<span class="dv">3</span>]), <span class="st">&#39;x_s&#39;</span>)
<span class="co">#&gt; $status</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1] &quot;neonira&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mode</span>
<span class="co">#&gt; [1] &quot;type_checking_enforcement&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter_type_checks</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_s         neonira     TRUE good type in values</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $function_return_type_check</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_s         neonira     TRUE good type in values</span></code></pre>
<p>Semantically, function <cite class='kw'>h</cite> takes a vector of strings as argument and returns a vector of strings.
As provided parameter <cite class='kw'>‘neonira’</cite> is a vector of type character, <cite class='kw'>parameter_type_checks</cite> succeed. As returned value is a vector of type character, <cite class='kw'>function_return_type_check</cite> also succeeds.</p>
<div id="wrong-parameter-type" class="section level4">
<h4><span class="header-section-number">7.3.1.1</span> Wrong parameter type</h4>
<p>Let’s change the provided argument from ‘neonira’ to pi value.</p>
<pre class="sourceCode r"><code class="sourceCode r">h &lt;-<span class="st"> </span><span class="cf">function</span>(x_s) x_s
<span class="kw">runTransientFunction</span>(h, <span class="kw">list</span>(pi), <span class="kw">EvaluationMode</span>(<span class="kw">defineEvaluationModes</span>()[<span class="dv">3</span>]), <span class="st">&#39;x_s&#39;</span>)
<span class="co">#&gt; $status</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1] 3.141593</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mode</span>
<span class="co">#&gt; [1] &quot;type_checking_enforcement&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter_type_checks</span>
<span class="co">#&gt;    parameter_name parameter_value validity              message</span>
<span class="co">#&gt; 1:            x_s        3.141593    FALSE wrong type in values</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $function_return_type_check</span>
<span class="co">#&gt;    parameter_name parameter_value validity              message</span>
<span class="co">#&gt; 1:            x_s        3.141593    FALSE wrong type in values</span></code></pre>
<p>We now face a case where function specification is unchanged but provided argument is not complying to specification.
Impact is <cite class='kw'>parameter_type_checks</cite> failure and <cite class='kw'>function_return_type_check</cite> failure.</p>
</div>
<div id="change-expected-return-type" class="section level4">
<h4><span class="header-section-number">7.3.1.2</span> Change expected return type</h4>
<p>Let’s change the expected function return type, to be double <cite class='comment'> <cite class='kw'>x_d</cite></cite>.</p>
<pre class="sourceCode r"><code class="sourceCode r">h &lt;-<span class="st"> </span><span class="cf">function</span>(x_s) x_s
<span class="kw">runTransientFunction</span>(h, <span class="kw">list</span>(pi), <span class="kw">EvaluationMode</span>(<span class="kw">defineEvaluationModes</span>()[<span class="dv">3</span>]), <span class="st">&#39;x_d&#39;</span>)
<span class="co">#&gt; $status</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1] 3.141593</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mode</span>
<span class="co">#&gt; [1] &quot;type_checking_enforcement&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter_type_checks</span>
<span class="co">#&gt;    parameter_name parameter_value validity              message</span>
<span class="co">#&gt; 1:            x_s        3.141593    FALSE wrong type in values</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $function_return_type_check</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_d        3.141593     TRUE good type in values</span></code></pre>
<p>We now face a case where function specification is unchanged but expected return type is expected to be a double. Provided argument is not complying to specification. Impact is <cite class='kw'>parameter_type_checks</cite> failure.</p>
</div>
</div>
<div id="prerequisite-mismatch" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Prerequisite mismatch</h3>
<p>What if function is not fulfilling prerequisites</p>
<pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) x <span class="co"># No semantic name compliance </span>
<span class="kw">runTransientFunction</span>(g, <span class="kw">list</span>(pi), <span class="kw">EvaluationMode</span>(<span class="kw">defineEvaluationModes</span>()[<span class="dv">3</span>]), <span class="st">&#39;x_d&#39;</span>)
<span class="co">#&gt; $status</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1] 3.141593</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mode</span>
<span class="co">#&gt; [1] &quot;type_checking_enforcement&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter_type_checks</span>
<span class="co">#&gt;    parameter_name parameter_value validity              message</span>
<span class="co">#&gt; 1:              x        3.141593    FALSE unknown suffix, [NA]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $function_return_type_check</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_d        3.141593     TRUE good type in values</span></code></pre>
<p>Impact is <cite class='kw'>parameter_type_checks</cite> failure.</p>
</div>
</div>
<div id="persistent-invocations" class="section level2 tabset tabset-fade tabset-pills">
<h2><span class="header-section-number">7.4</span> Persistent invocations</h2>
<p>Transient invocations are convenient but limited. Especially, when you create classes, they do not appear to be as friendly and useful as necessary. When dealing with your own class code, you may opt for an easier and more industrial approach that is class instrumentation. Prerequisite remains the same, but you may fulfill them much more easily by defining a variable named <cite class='kw'>function_return_type</cite> in your class. Let’s see an example.</p>
<div id="nominal-persistent-case" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Nominal persistent case</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="kw">system.file</span>(<span class="st">&#39;code-samples/fun-defs/good/partial/AdditionFIPartial.R&#39;</span>, <span class="dt">package =</span> <span class="st">&#39;wyz.code.offensiveProgramming&#39;</span>))
<span class="kw">runFunction</span>(<span class="kw">AdditionFIPartial</span>(), <span class="st">&#39;addInteger&#39;</span>, <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">8</span>), <span class="kw">EvaluationMode</span>(<span class="kw">defineEvaluationModes</span>()[<span class="dv">3</span>]))
<span class="co">#&gt; $status</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1]  7  9 11</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mode</span>
<span class="co">#&gt; [1] &quot;type_checking_enforcement&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter_type_checks</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_i           1,2,3     TRUE good type in values</span>
<span class="co">#&gt; 2:            y_i           6,7,8     TRUE good type in values</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $function_return_type_check</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_i         7, 9,11     TRUE good type in values</span></code></pre>
<p>We now face a case where function specification is expecting to sum integers. Provided arguments are complying to specification. Impact is <cite class='kw'>parameter_type_checks</cite> success and <cite class='kw'>function_return_type_check</cite> success.</p>
</div>
<div id="subtile-change" class="section level3">
<h3><span class="header-section-number">7.4.2</span> Subtile change</h3>
<p>Just change the function name. Now expectations brought by the function definition are not the same. This leads to a completely different result.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">runFunction</span>(<span class="kw">AdditionFIPartial</span>(), <span class="st">&#39;addDouble&#39;</span>, <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">8</span>), <span class="kw">EvaluationMode</span>(<span class="kw">defineEvaluationModes</span>()[<span class="dv">3</span>]))
<span class="co">#&gt; $status</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1]  7  9 11</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mode</span>
<span class="co">#&gt; [1] &quot;type_checking_enforcement&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter_type_checks</span>
<span class="co">#&gt;    parameter_name parameter_value validity              message</span>
<span class="co">#&gt; 1:            x_d           1,2,3    FALSE wrong type in values</span>
<span class="co">#&gt; 2:            y_d           6,7,8    FALSE wrong type in values</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $function_return_type_check</span>
<span class="co">#&gt;    parameter_name parameter_value validity              message</span>
<span class="co">#&gt; 1:            x_d         7, 9,11    FALSE wrong type in values</span></code></pre>
</div>
<div id="call-case-with-named-and-positional-parameters" class="section level3">
<h3><span class="header-section-number">7.4.3</span> Call case with named and positional parameters</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">runFunction</span>(<span class="kw">AdditionFIPartial</span>(), <span class="st">&#39;addInteger&#39;</span>, <span class="kw">list</span>(<span class="dt">y_i =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">8</span>), <span class="kw">EvaluationMode</span>(<span class="kw">defineEvaluationModes</span>()[<span class="dv">3</span>]))
<span class="co">#&gt; $status</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1]  7  9 11</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mode</span>
<span class="co">#&gt; [1] &quot;type_checking_enforcement&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter_type_checks</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            y_i           1,2,3     TRUE good type in values</span>
<span class="co">#&gt; 2:            x_i           6,7,8     TRUE good type in values</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $function_return_type_check</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_i         7, 9,11     TRUE good type in values</span></code></pre>
<p>Look at <cite class='kw'>parameter_type_checks</cite> to ensure arguments are well associated.</p>
</div>
<div id="call-case-with-ellipsis" class="section level3">
<h3><span class="header-section-number">7.4.4</span> Call case with ellipsis</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">runFunction</span>(<span class="kw">AdditionFIPartial</span>(), <span class="st">&#39;addMultiDouble&#39;</span>, <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>), <span class="kw">EvaluationMode</span>(<span class="kw">defineEvaluationModes</span>()[<span class="dv">3</span>]))
<span class="co">#&gt; $status</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1] 34</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mode</span>
<span class="co">#&gt; [1] &quot;type_checking_enforcement&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter_type_checks</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            ...           1,2,3     TRUE ellispsis match all</span>
<span class="co">#&gt; 2:            ... 1,2,3,4,5,6,...     TRUE ellispsis match all</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $function_return_type_check</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_d              34     TRUE good type in values</span></code></pre>
</div>
<div id="second-call-case-with-ellipsis" class="section level3">
<h3><span class="header-section-number">7.4.5</span> Second call case with ellipsis</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">runFunction</span>(<span class="kw">AdditionFIPartial</span>(), <span class="st">&#39;addMultiInteger&#39;</span>, <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">0</span>, <span class="kw">floor</span>(pi)), <span class="kw">EvaluationMode</span>(<span class="kw">defineEvaluationModes</span>()[<span class="dv">3</span>]))
<span class="co">#&gt; $status</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1] 32 33 34</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mode</span>
<span class="co">#&gt; [1] &quot;type_checking_enforcement&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter_type_checks</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_i           1,2,3     TRUE good type in values</span>
<span class="co">#&gt; 2:            ... 1,2,3,4,5,6,...     TRUE ellispsis match all</span>
<span class="co">#&gt; 3:            ...               0     TRUE ellispsis match all</span>
<span class="co">#&gt; 4:            ...               3     TRUE ellispsis match all</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $function_return_type_check</span>
<span class="co">#&gt;    parameter_name parameter_value validity              message</span>
<span class="co">#&gt; 1:            x_i        32,33,34    FALSE wrong type in values</span></code></pre>
<p>Two issues here. Value 0 is double, not integer and <cite class='kw'>floor</cite> function returns also a double. To get a correct results here is how to transform the call</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">runFunction</span>(<span class="kw">AdditionFIPartial</span>(), <span class="st">&#39;addMultiInteger&#39;</span>, <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, 0L, <span class="kw">as.integer</span>(<span class="kw">floor</span>(pi))), <span class="kw">EvaluationMode</span>(<span class="kw">defineEvaluationModes</span>()[<span class="dv">3</span>]))
<span class="co">#&gt; $status</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $value</span>
<span class="co">#&gt; [1] 32 33 34</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mode</span>
<span class="co">#&gt; [1] &quot;type_checking_enforcement&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter_type_checks</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_i           1,2,3     TRUE good type in values</span>
<span class="co">#&gt; 2:            ... 1,2,3,4,5,6,...     TRUE ellispsis match all</span>
<span class="co">#&gt; 3:            ...               0     TRUE ellispsis match all</span>
<span class="co">#&gt; 4:            ...               3     TRUE ellispsis match all</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $function_return_type_check</span>
<span class="co">#&gt;    parameter_name parameter_value validity             message</span>
<span class="co">#&gt; 1:            x_i        32,33,34     TRUE good type in values</span></code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="evaluation-modes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="running-test-cases.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "night",
"family": "serif",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": ["offensive-programming-book.pdf"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
